<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>客服云线上webim集成</title>
		<link rel="stylesheet" type="text/css" href="css/webim.css" />
	</head>
	<body>

		<!-- <button type="button">
			<a href='javascript:;' onclick='easemobim.bind({configId: "6d1bee7d-616d-4d24-847d-4585916844b0"})'>未认证窗口</a></h1>
		</button> -->
		
		<button type="button">
			<a href='javascript:;'  onclick="test()" >自定义按钮</a>
		</button>
		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			
			window.easemobim = window.easemobim || {};
			
			easemobim.config = {
				// hide: true,
				routingRuleFlag:'小鹤',
				visitor: {
					trueName: '姓名',
					qq: 'JQKA',
					phone: '188****8888',
					companyName: '环信',
					userNickname: 'aaa',
					description: '描述信息aaa',
					email: 'JQKA@qq.com',
					tags: [
						'vip1'
					],
					userDefineColumn: '{"test":"aaa","IDCARD":"身份证号abcd","idcard":"123456789"}'
				}
			};
			
			function test(){
				window.easemobim.bind({ 
					// tenantId: "53690",
					configId: '8cc4e1b1-e94e-4643-9d90-fd3fe3fa37b9',
					// domain: '//kefu.easemob.com',
					onready: function(){ 
						console.log("onready")
						// sendCrmExt();
					},
					onclose: function(){
						console.log("onclose")
					},
					onopen: function(){
						console.log("onopen")
					},
					onEvaluationsubmit: function(){
						console.log("onEvaluationsubmit")
					},
					onmessage: function(){
						console.log("onmessage")
					},
					onsessionclosed: function(){
						console.log("onsessionclosed")
					},
					onsessioncreat: function(){
						console.log("oncreat")
					}
					/*extMsg:{
					    cmd:{
					        updateVisitorInfoSrc:{
					            params:{
					                uid: "cxn111111"
					            }
					        }
					    }
					}*/
				});
			}

			function callbackSessionclosed() {
				flag = true;
				console.log("callbackSessionclosed: ", flag);
			}

			function callbackMessage(message) {
				console.log("callbackMessage: ", flag);
				if (flag) {
					console.log("发送CRM消息！！！");
					sendCrmExtendMessage();
					flag = false;
				}
			}
		</script>
		<script src='https://kefu.easemob.com/webim/easemob.js?configId=8cc4e1b1-e94e-4643-9d90-fd3fe3fa37b9'></script>
	</body>
</html>
